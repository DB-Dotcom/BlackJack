const franzoesischesBlatt = [
    // Herz
    {
      name: "HerzZahl2",
      wert: 2,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 2               |
       |    ♥         ♥  |
       |               2 |
       '-----------------'`,
      id: 0,
    },
    {
      name: "HerzZahl3",
      wert: 3,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 3               |
       |    ♥   3   ♥    |
       |               3 |
       '-----------------'`,
      id: 1,
    },
    {
      name: "HerzZahl4",
      wert: 4,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 4           4   |
       |    ♥         ♥  |
       |   4           4 |
       '-----------------'`,
      id: 2,
    },
    {
      name: "HerzZahl5",
      wert: 5,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 5             5 |
       |    ♥     5   ♥  |
       | 5             5 |
       '-----------------'`,
      id: 3,
    },
    {
      name: "HerzZahl6",
      wert: 6,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 6            6 |
       |    ♥  6   ♥    |
       | 6            6 |
       '-----------------'`,
      id: 4,
    },
    {
      name: "HerzZahl7",
      wert: 7,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 7             7 |
       |    ♥   7   ♥    |
       | 7             7 |
       '-----------------'`,
      id: 5,
    },
    {
      name: "HerzZahl8",
      wert: 8,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 8             8 |
       |     ♥  8   ♥    |
       | 8             8 |
       '-----------------'`,
      id: 6,
    },
    {
      name: "HerzZahl9",
      wert: 9,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 9             9 |
       |     ♥  9   ♥    |
       | 9             9 |
       '-----------------'`,
      id: 7,
    },
    {
      name: "HerzZahl10",
      wert: 10,
      farbe: "Herz",
      bild: `
       .-----------------.
       | 10           10 |
       |    ♥   10  ♥    |
       | 10           10 |
       '-----------------'`,
      id: 8,
    },
    {
      name: "HerzBube",
      wert: 10,
      farbe: "Herz",
      bild: `
       .-----------------.
       | Bube        Bube|
       |    ♥         ♥  |
       | Bube        Bube|
       '-----------------'`,
      id: 9,
    },
    {
      name: "HerzDame",
      wert: 10,
      farbe: "Herz",
      bild: `
       .-----------------.
       | Dame        Dame|
       |    ♥         ♥  |
       | Dame        Dame|
       '-----------------'`,
      id: 10,
    },
    {
      name: "HerzKönig",
      wert: 10,
      farbe: "Herz",
      bild: `
       .-----------------.
       | König      König|
       |    ♥         ♥  |
       | König      König|
       '-----------------'`,
      id: 11,
    },
    {
      name: "HerzAss",
      wert: 11,
      farbe: "Herz",
      bild: `
       .-----------------.
       | Ass          Ass|
       |    ♥         ♥  |
       | Ass          Ass|
       '-----------------'`,
      id: 12,
    },
  
    // Karo
    {
      name: "KaroZahl2",
      wert: 2,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 2               |
       |    ♦         ♦  |
       |               2 |
       '-----------------'`,
      id: 13,
    },
    {
      name: "KaroZahl3",
      wert: 3,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 3               |
       |    ♦   3   ♦    |
       |               3 |
       '-----------------'`,
      id: 14,
    },
    {
      name: "KaroZahl4",
      wert: 4,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 4           4   |
       |    ♦         ♦  |
       |   4           4 |
       '-----------------'`,
      id: 15,
    },
    {
      name: "KaroZahl5",
      wert: 5,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 5           5   |
       |    ♦     5   ♦  |
       |   5           5 |
       '-----------------'`,
      id: 16,
    },
    {
      name: "KaroZahl6",
      wert: 6,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 6             6 |
       |     ♦  6   ♦    |
       | 6             6 |
       '-----------------'`,
      id: 17,
    },
    {
      name: "KaroZahl7",
      wert: 7,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 7             7 |
       |     ♦  7   ♦    |
       | 7             7 |
       '-----------------'`,
      id: 18,
    },
    {
      name: "KaroZahl8",
      wert: 8,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 8             8 |
       |     ♦  8   ♦    |
       | 8             8 |
       '-----------------'`,
      id: 19,
    },
    {
      name: "KaroZahl9",
      wert: 9,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 9             9 |
       |     ♦  9   ♦    |
       | 9             9 |
       '-----------------'`,
      id: 20,
    },
    {
      name: "KaroZahl10",
      wert: 10,
      farbe: "Karo",
      bild: `
       .-----------------.
       | 10           10 |
       |    ♦   10  ♦    |
       | 10           10 |
       '-----------------'`,
      id: 21,
    },
    {
      name: "KaroBube",
      wert: 10,
      farbe: "Karo",
      bild: `
       .-----------------.
       | Bube        Bube|
       |    ♦         ♦  |
       | Bube        Bube|
       '-----------------'`,
      id: 22,
    },
    {
      name: "KaroDame",
      wert: 10,
      farbe: "Karo",
      bild: `
       .-----------------.
       | Dame        Dame|
       |    ♦         ♦  |
       | Dame        Dame|
       '-----------------'`,
      id: 23,
    },
    {
      name: "KaroKönig",
      wert: 10,
      farbe: "Karo",
      bild: `
       .-----------------.
       | König      König|
       |    ♦         ♦  |
       | König      König|
       '-----------------'`,
      id: 24,
    },
    {
      name: "KaroAss",
      wert: 11,
      farbe: "Karo",
      bild: `
       .-----------------.
       | Ass          Ass|
       |    ♦         ♦  |
       | Ass          Ass|
       '-----------------'`,
      id: 25,
    },
  
    // Pik
    {
      name: "PikZahl2",
      wert: 2,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 2               |
       |    ♠         ♠  |
       |               2 |
       '-----------------'`,
      id: 26,
    },
    {
      name: "PikZahl3",
      wert: 3,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 3               |
       |    ♠   3   ♠    |
       |               3 |
       '-----------------'`,
      id: 27,
    },
    {
      name: "PikZahl4",
      wert: 4,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 4             4 |
       |    ♠         ♠  |
       | 4             4 |
       '-----------------'`,
      id: 28,
    },
    {
      name: "PikZahl5",
      wert: 5,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 5             5 |
       |    ♠   5   ♠    |
       | 5             5 |
       '-----------------'`,
      id: 29,
    },
    {
      name: "PikZahl6",
      wert: 6,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 6             6 |
       |     ♠  6   ♠    |
       | 6             6 |
       '-----------------'`,
      id: 30,
    },
    {
      name: "PikZahl7",
      wert: 7,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 7             7 |
       |    ♠   7   ♠    |
       | 7             7 |
       '-----------------'`,
      id: 31,
    },
    {
      name: "PikZahl8",
      wert: 8,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 8             8 |
       |     ♠  8   ♠    |
       | 8             8 |
       '-----------------'`,
      id: 32,
    },
    {
      name: "PikZahl9",
      wert: 9,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 9             9 |
       |     ♠  9   ♠    |
       | 9             9 |
       '-----------------'`,
      id: 33,
    },
    {
      name: "PikZahl10",
      wert: 10,
      farbe: "Pik",
      bild: `
       .-----------------.
       | 10          10  |
       |    ♠   10  ♠    |
       | 10           10 |
       '-----------------'`,
      id: 34,
    },
    {
      name: "PikBube",
      wert: 10,
      farbe: "Pik",
      bild: `
       .-----------------.
       | Bube        Bube|
       |    ♠         ♠  |
       | Bube        Bube|
       '-----------------'`,
      id: 35,
    },
    {
      name: "PikDame",
      wert: 10,
      farbe: "Pik",
      bild: `
       .-----------------.
       | Dame        Dame|
       |    ♠         ♠  |
       | Dame        Dame|
       '-----------------'`,
      id: 36,
    },
    {
      name: "PikKönig",
      wert: 10,
      farbe: "Pik",
      bild: `
       .-----------------.
       | König      König|
       |    ♠         ♠  |
       | König      König|
       '-----------------'`,
      id: 37,
    },
    {
      name: "PikAss",
      wert: 11,
      farbe: "Pik",
      bild: `
       .-----------------.
       | Ass          Ass|
       |    ♠         ♠  |
       | Ass          Ass|
       '-----------------'`,
      id: 38,
    },
  
    // Kreuz
    {
      name: "KreuzZahl2",
      wert: 2,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 2               |
       |    ♣         ♣  |
       |               2 |
       '-----------------'`,
      id: 39,
    },
    {
      name: "KreuzZahl3",
      wert: 3,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 3               |
       |    ♣   3   ♣    |
       |               3 |
       '-----------------'`,
      id: 40,
    },
    {
      name: "KreuzZahl4",
      wert: 4,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 4             4 |
       |    ♣         ♣  |
       | 4             4 |
       '-----------------'`,
      id: 41,
    },
    {
      name: "KreuzZahl5",
      wert: 5,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 5             5 |
       |    ♣    5   ♣   |
       | 5             5 |
       '-----------------'`,
      id: 42,
    },
    {
      name: "KreuzZahl6",
      wert: 6,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 6             6 |
       |     ♣  6   ♣    |
       | 6             6 |
       '-----------------'`,
      id: 43,
    },
    {
      name: "KreuzZahl7",
      wert: 7,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 7             7 |
       |    ♣   7   ♣    |
       | 7             7 |
       '-----------------'`,
      id: 44,
    },
    {
      name: "KreuzZahl8",
      wert: 8,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 8             8 |
       |    ♣   8   ♣    |
       | 8             8 |
       '-----------------'`,
      id: 45,
    },
    {
      name: "KreuzZahl9",
      wert: 9,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 9             9 |
       |     ♣  9   ♣    |
       | 9             9 |
       '-----------------'`,
      id: 46,
    },
    {
      name: "KreuzZahl10",
      wert: 10,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | 10          10  |
       |    ♣   10  ♣    |
       | 10           10 |
       '-----------------'`,
      id: 47,
    },
    {
      name: "KreuzBube",
      wert: 10,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | Bube        Bube|
       |    ♣         ♣  |
       | Bube        Bube|
       '-----------------'`,
      id: 48,
    },
    {
      name: "KreuzDame",
      wert: 10,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | Dame        Dame|
       |    ♣         ♣  |
       | Dame        Dame|
       '-----------------'`,
      id: 49,
    },
    {
      name: "KreuzKönig",
      wert: 10,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | König      König|
       |    ♣         ♣  |
       | König      König|
       '-----------------'`,
      id: 50,
    },
    {
      name: "KreuzAss",
      wert: 11,
      farbe: "Kreuz",
      bild: `
       .-----------------.
       | Ass          Ass|
       |    ♣         ♣  |
       | Ass          Ass|
       '-----------------'`,
      id: 51,
    },
  ];
  

  const faceDownBlatt = [
    // FaceDown
    {
      name: "FaceDown",
      bild: `
       .-----------------.
       | ############### |
       | ############### |
       | ############### |
       '-----------------'`,
      id: 0,
    },
]

// ----------------------------------------- game code ------------------------------------------------------------------
  
import readline from 'node:readline'
  
const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
})

// ---------------------------------------- variable  -----------------------------------------------------------


let spielerHand = [];
let dealerHand = [];
let deck = [...franzoesischesBlatt];
let spielerPunkte = 0;
let dealerPunkte = 0;
let spielerCoins = 1000; // Starteinlage des Spielers
let aktuellerEinsatz = 10; // Der Standard-Einsatz zu Beginn


//***************************************************************** end

// ---------------------------------------- functions game logic -----------------------------------------------------------
function randomKarte () {
  const randomIndex = Math.floor(Math.random() * deck.length)
  return deck.splice(randomIndex, 1)[0] // Zieht eine zufällige Karte aus dem Deck und entfernt sie daraus.
}

function berechnePunkte (hand) {
  return hand.reduce((sum, karte) => sum + karte.wert, 0) // Berechnet die Gesamtpunktzahl einer Hand.
}

function zeigeSpielerHand () {
  spielerHand.forEach(karte => console.log(karte.bild)) // Zeigt die Karten in der Spielerhand.
  console.log(`Spielerpunkte: ${spielerPunkte}`) // Zeigt die Gesamtpunktzahl des Spielers.
}

function zeigeDealerHand () {
  console.log('Dealerhand:')
  dealerHand.forEach(karte => console.log(karte.bild)) // Zeigt die Karten in der Dealerhand.
  console.log(`Dealerpunkte: ${dealerPunkte}`) // Zeigt die Gesamtpunktzahl des Dealers.
}

function dealerZug () {
  while (dealerPunkte < 17) {
    const karte = randomKarte()
    dealerHand.push(karte) // Der Dealer zieht Karten, bis er mindestens 17 Punkte hat.
    dealerPunkte = berechnePunkte(dealerHand)
  }
  zeigeDealerHand()
}

// ******************************************************************** end


function neustart() {
  spielerHand = [];
  dealerHand = [];
  deck = [...franzoesischesBlatt];
  spielerPunkte = 0;
  dealerPunkte = 0;
  aktuellerEinsatz = 10; // Setzt den Einsatz auf den Standardwert zurück
  starteSpiel();
}



function beendeSpiel () {
  rl.question('Möchtest du nochmal spielen? (ja/nein): ', antwort => {
    if (antwort.toLowerCase() === 'ja') {
      neustart() // Startet ein neues Spiel, wenn der Spieler "ja" sagt.
    } else {
      console.log('Spiel beendet. Auf Wiedersehen!')
      rl.close() // Beendet das Spiel, wenn der Spieler "nein" sagt.
    }
  })
}

// ---------------------------------------- Spiel start -----------------------------------------------------------

function starteSpiel () {
  spielerHand.push(randomKarte())
  spielerHand.push(randomKarte())
  dealerHand.push(randomKarte())
  dealerHand.push(randomKarte())

  spielerPunkte = berechnePunkte(spielerHand)
  dealerPunkte = berechnePunkte(dealerHand)

  /* console.log('Willkommen beim Blackjack-Spiel!\n') */

  console.log('Willkommen beim Blackjack-Spiel!\n');
  console.log(`Du hast ${spielerCoins} Coins.`);
  console.log(`Aktueller Einsatz: ${aktuellerEinsatz} Coins.\n`);


  // Zeige die Anfangshand

  console.log('Deine Hand:')
  spielerHand.forEach(karte => console.log(karte.bild)) // Zeigt die Karten in der Spielerhand.
  console.log(`Deine Punkte: ${spielerPunkte}\n`) // Zeigt die Gesamtpunktzahl des Spielers.

  

  function spielerZug() {
    rl.question(
      `Möchtest du "hit" (eine Karte ziehen) oder "stand" (behalten)? Aktueller Einsatz: ${aktuellerEinsatz} Coins. `,
      antwort => {
        if (antwort.toLowerCase() === 'hit') {
          const karte = randomKarte();
          spielerHand.push(karte);
          spielerPunkte = berechnePunkte(spielerHand);
          zeigeSpielerHand();
  
          if (spielerPunkte > 21) {
            console.log('Du hast verloren! Du hast mehr als 21 Punkte.');
            spielerCoins -= aktuellerEinsatz;
            beendeSpiel();
          } else {
            spielerZug();
          }
        } else if (antwort.toLowerCase() === 'stand') {
          dealerZug();
          if (dealerPunkte > 21 || dealerPunkte < spielerPunkte || spielerPunkte === 21) {
            console.log('Glückwunsch! Du hast gewonnen.');
            if (spielerPunkte === 21) {
              console.log('Blackjack.');
              spielerCoins += aktuellerEinsatz * 2; // Der Spieler gewinnt das Doppelte des Einsatzes zurück.
            } else {
              spielerCoins += aktuellerEinsatz;
            }
          } else if (dealerPunkte === spielerPunkte) {
            console.log('Unentschieden! Niemand gewinnt.');
          } else {
            console.log('Dealer gewinnt! Du hast verloren.');
            spielerCoins -= aktuellerEinsatz;
          }
          console.log(`Du hast jetzt ${spielerCoins} Coins.\n`);
          beendeSpiel();
        } else {
          console.log('Ungültige Eingabe. Bitte gib "hit" oder "stand" ein.');
          spielerZug();
        }
      }
    );
  }
  


 
  // ******************************************************************** end

  spielerZug() // Startet den Spielerzug.
}

starteSpiel() // Startet das Spiel.
